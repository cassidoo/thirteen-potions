<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Thirteen Potions</title>
		<script src="./phaser.min.js"></script>
		<style type="text/css">
			html,
			body,
			#game-container {
				margin: 0;
				padding: 0;
				background: #3b2731;
			}

			#game-container {
				min-width: 100vw;
				min-height: 100vh;
				display: flex;
				align-items: center;
				justify-content: center;
			}
		</style>
		<script type="text/javascript">
			let config = {
				type: Phaser.AUTO,
				width: 400,
				height: 300,
				parent: "game-container",
				pixelArt: true,
				scene: {
					preload: preload,
					create: create,
					update: update,
				},
				physics: {
					default: "arcade",
					arcade: {
						gravity: { y: 0 }, // Top down game, so no gravity
					},
				},
			};

			let game = new Phaser.Game(config);
			let controls;
			let player;

			// Runs once, loads up assets like images and audio
			function preload() {
				this.load.image("tiles", "./tilemap_packed.png");
				this.load.tilemapTiledJSON("map", "./map.json");
			}

			// Runs once, after all assets in preload
			function create() {
				const map = this.make.tilemap({ key: "map" });
				const tileset = map.addTilesetImage("thirteen-potions", "tiles");

				// Parameters: layer name (or index) from Tiled, tileset, x, y
				const groundLayer = map.createLayer("Ground", tileset, 0, 0);
				const wallLayer = map.createLayer("Walls", tileset, 0, 0);
				wallLayer.setCollisionByProperty({ collides: true });

				// Phaser supports multiple cameras, but you can access the default camera like this:
				let camera = this.cameras.main;

				camera.width = 400;
				camera.height = 300;
				camera.scrollX = 320;
				camera.scrollY = -75;
				camera.zoom = 3;

				// Set up the arrows to control the camera
				const cursors = this.input.keyboard.createCursorKeys();
				controls = new Phaser.Cameras.Controls.FixedKeyControl({
					camera: camera,
					left: cursors.left,
					right: cursors.right,
					up: cursors.up,
					down: cursors.down,
					speed: 0.2,
				});

				// Constrain the camera
				camera.setBounds(0, 0, 720, 480);
			}

			// Runs once per frame for the duration of the scene
			function update(time, delta) {
				controls.update(delta);
			}
		</script>
	</head>
	<body>
		<div id="game-container"></div>
		<!-- <img src="./tilemap_packed.png" alt="tilemap" /> -->
	</body>
</html>
